# 秒杀商品导航功能说明

## 功能概述

在导航栏的"饰品"选项右侧新增了"秒杀商品"选项，用户可以点击查看正在进行秒杀活动的商品。

## 实现内容

### 1. 后端API修改

**文件**: `internal/server/router.go`

- 在 `/api/products` 接口中添加了 `seckill_only` 参数支持
- 当 `seckill_only=true` 时，只返回状态为 `2`（秒杀中）的商品
- 过滤逻辑在关键字搜索之前执行，确保只返回秒杀商品

```go
seckillOnly := ctx.URLParam("seckill_only") == "true"
if seckillOnly {
    filtered := make([]*product.Product, 0, len(list))
    for _, p := range list {
        if p.Status == 2 {
            filtered = append(filtered, p)
        }
    }
    list = filtered
}
```

### 2. 前端导航栏修改

**文件**: `web/index.html`

- 在导航栏"饰品"选项后添加了"秒杀商品"链接
- 使用 `seckill-filter` 类名和 `data-seckill="true"` 属性标识

```html
<li class="nav__dropdown">
    <a href="javascript:void(0)" class="seckill-filter" data-seckill="true">秒杀商品</a>
</li>
```

### 3. 前端JavaScript功能

**文件**: `web/index.html`

#### 3.1 修改 `loadProducts` 函数
- 添加了 `seckillOnly` 参数
- 当 `seckillOnly=true` 时，在API请求中添加 `seckill_only=true` 参数
- 根据是否筛选秒杀商品，动态更新页面标题和描述

#### 3.2 添加秒杀商品按钮点击事件
- 点击"秒杀商品"时，清除分类筛选，只显示秒杀商品
- 保留当前搜索关键字
- 更新导航栏激活状态

#### 3.3 页面标题动态更新
- 添加了 `product-section-title` 和 `product-section-desc` ID
- 当显示秒杀商品时，标题改为"秒杀商品"，描述改为"以下为正在进行秒杀活动的商品 点击即可进入商品详情页"
- 当显示普通商品时，标题为"在线商品"，描述为"以下为所有的在线商品 点击即可进入商品详情页"

#### 3.4 搜索功能兼容
- 搜索时保持秒杀筛选状态
- 如果当前激活了"秒杀商品"，搜索时仍然只显示秒杀商品

## 使用方式

1. **查看秒杀商品**：
   - 点击导航栏中的"秒杀商品"选项
   - 页面会显示所有正在进行秒杀活动的商品
   - 页面标题会变为"秒杀商品"

2. **搜索秒杀商品**：
   - 先点击"秒杀商品"激活筛选
   - 然后在搜索框输入关键字
   - 搜索结果会只显示匹配关键字的秒杀商品

3. **切换回普通商品**：
   - 点击"首页"、"男士"、"女士"或"饰品"任一选项
   - 页面会恢复显示所有在线商品

## API使用示例

### 获取所有秒杀商品
```
GET /api/products?seckill_only=true
```

### 搜索秒杀商品
```
GET /api/products?seckill_only=true&q=关键字
```

### 按分类获取秒杀商品（如果分类中有秒杀商品）
```
GET /api/products?category=men&seckill_only=true
```

## 注意事项

1. **商品状态**：只有状态为 `2`（秒杀中）的商品才会在"秒杀商品"页面显示
2. **活动过期**：如果秒杀活动已过期，商品状态会自动恢复为 `1`（正常），不再显示在秒杀商品列表中
3. **空列表提示**：如果没有正在进行秒杀活动的商品，会显示"当前没有正在进行秒杀活动的商品。"
4. **兼容性**：与现有的分类筛选和关键字搜索功能完全兼容

## 测试方法

1. 启动web服务：`go run ./cmd/web`
2. 访问首页，查看导航栏是否显示"秒杀商品"选项
3. 点击"秒杀商品"，查看是否只显示状态为2的商品
4. 测试搜索功能，确认搜索时保持秒杀筛选状态
5. 测试切换分类，确认可以切换回普通商品列表

## 修改的文件

1. `internal/server/router.go` - 添加 `seckill_only` 参数支持
2. `web/index.html` - 添加导航项、修改JavaScript函数、添加事件处理
